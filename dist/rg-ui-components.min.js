!function(n){function i(i){i.decorator("GridOptions",["$delegate","i18nService",function(i,e){var t;return t=n.copy(i),t.initialize=function(n){var e;return e=i.initialize(n)},e.setCurrentLang("es"),t}])}n.module("uiComponents.config",[]).value("uiComponents.config",{debug:!0}).config(i),n.module("uiComponents.filters",[]),n.module("uiComponents.components",["ui.grid","ui.grid.exporter","ui.grid.selection","ui.grid.pagination","ui.grid.pinning","ui.grid.moveColumns","ui.grid.edit","ui.grid.rowEdit"]),n.module("uiComponents",["uiComponents.config","uiComponents.components","uiComponents.filters"])}(angular),function(n){"use strict";function i(){return function(i,e){var t=[];if(n.isArray(i)){var o=Object.keys(e);i.forEach(function(n){for(var i=!1,a=0;a<o.length;a++){var c=o[a],d=e[c].toLowerCase();if(-1!==n[c].toString().toLowerCase().indexOf(d)){i=!0;break}}i&&t.push(n)})}else t=i;return t}}n.module("uiComponents.filters").filter("propsFilter",i)}(angular),function(n){"use strict";n.module("uiComponents.filters",[])}(angular),function(n){"use strict";var i={restrict:"E",template:'<div class="myGrid" id="grid1" ui-grid="lrc.optionsEntidades"  ui-grid-exporter  ui-grid-selection  ui-grid-expandable ui-grid-pagination ui-grid-edit  ui-grid-row-edit ui-grid-move-columns ui-grid-pinning ui-grid-resize-columns  bs-loading-overlay></div>',controller:"ListadoEntidadController as lrc",bindings:{selectAll:"=?",deselectedAll:"=?",entidades:"=?",entidadesSeleccionadas:"=?",servicio:"=?",gridOptions:"<",config:"<?",path:"<?",clickItem:"&?",metodos:"=?"}};n.module("uiComponents.components").component("listadoEntidad",i)}(angular),function(n){"use strict";function i(i,e,t,o,a,c,d){function s(){r(p.path,100,void 0,p.config.links)}function r(n,i,e,t){p.servicio.obtenerDatos(n,t,i,e).then(function(n){p.entidades=n,p.optionsEntidades.data=n,p.optionsEntidades.totalItems=p.entidades.length,l()})}function l(){p.selectAll&&(p.gridApi.grid.modifyRows(p.optionsEntidades.data),p.gridApi.selection.selectAllRows())}function u(){console.log(p.optionsEntidades),p.optionsEntidades.onRegisterApi=function(i){p.gridApi=i,i.expandable.on.rowExpandedStateChanged(e,function(i){i.isExpanded&&(i.entity.subGridOptions=n.copy(p.optionsEntidades.subGridColumnDefs),p.config.datosSubgrilla?i.entity.subGridOptions.data=p.servicio.agregarFuncionesSubgrilla(i.entity[p.config.campoDatosSubgrilla])||[]:p.servicio.obtenerDatosSubgrilla(i.entity._links[p.config.subGrilla].href).then(function(n){i.entity.subGridOptions.data=n}))}),i.pagination.on.paginationChanged(e,function(){}),i.selection.on.rowSelectionChanged(e,function(){p.entidadesSeleccionadas=i.selection.getSelectedRows(),"undefined"!=typeof p.clickItem&&p.clickItem({$entidad:p.entidadesSeleccionadas,$entidadesSeleccionadas:p.entidadesSeleccionadas})}),i.selection.on.rowSelectionChangedBatch(e,function(){p.entidadesSeleccionadas=i.selection.getSelectedRows(),"undefined"!=typeof p.clickItem&&p.clickItem({$entidad:p.entidadesSeleccionadas,$entidadesSeleccionadas:p.entidadesSeleccionadas})}),g&&t(function(){l()},150)}}var g=!1,p=this;p.$onInit=function(){p.selected={},p.deselectedAll=!1,d.setCurrentLang("es"),p.gridApi=null,p.optionsEntidades=n.copy(p.gridOptions),p.metodosInternos=p.metodos||{},p.metodosInternos.actualizarDatos=s,void 0===p.entidades||0===p.entidades.length?r(p.path,100,void 0,p.config.links):(g=!0,p.optionsEntidades.data=p.entidades),u()}}n.module("uiComponents.components").controller("ListadoEntidadController",i)}(angular),function(){"use strict";function n(n,i,e){function t(){return d.configuracionTabla.title?d.configuracionTabla.title:""}function o(n){d.entitdadSeleccionada=n[0]}function a(){n.close(d.entitdadSeleccionada)}function c(){n.dismiss()}var d=this;d.configuracionTabla=i,d.entidades=e,d.aceptar=a,d.cancelar=c,d.getTitle=t,d.clickEntidad=o}angular.module("uiComponents.components").controller("BuscarEntidadController",n)}(),function(n){"use strict";var i;i={restrict:"E",template:'<div class="input-group">   <ui-select class="bootstrap-select form-control" ng-model="sc.ultimaEntidad" on-select="sc.onSelect($item)"><ui-select-match placeholder="{{sc.configuracion.placeholder}}">{{sc.cargarCampos($select)}}</ui-select-match>    <ui-select-choices style="margin-top: 34px" repeat="entidad in sc.entidades | propsFilter: sc.getSearch($select)">        <span ng-bind-html="entidad[sc.configuracion.campos[0].field] | highlight: $select.search"></span> <small ng-repeat="subcampo in sc.configuracion.subcampos">{{subcampo.title}}: <span ng-bind-html="\'\'+ sc.byString(entidad,subcampo.field) | highlight: $select.search"> </span></small>     </ui-select-choices>        </ui-select>       <span class="input-group-btn" ng-if="sc.busquedaAvanzada">      <button type="button" ng-click="sc.showBuscar()" class="btn btn-default">      <span class="ion-ios-search-strong"></span>      </button>      </span></div>',controller:"SelectController as sc",bindings:{url:"<?",configuracion:"<?",searchEnabled:"<?",servicio:"<?",parametros:"<?",entidades:"<?",ultimaEntidad:"=?",busquedaAvanzada:"<?",clickItem:"&?",onLoadData:"&?"}},n.module("uiComponents.components").component("selectData",i)}(angular),function(n){"use strict";function i(n){function i(n){var i={};return void 0===r.configuracion.fieldsToSearch?(r.configuracion.campos.forEach(function(e){i[e.field]=n.search}),r.configuracion.subcampos.forEach(function(e){i[e.field]=n.search})):r.configuracion.fieldsToSearch.forEach(function(e){i[e.field]=n.search}),i}function e(){return r.searchEnabled||!0}function t(){var i=n.open({animation:!0,template:'<!-- HEADER -->                <div class="modal-header">                    <h3 class="modal-title" id="modal-title">{{bac.getTitle()}}</h3>                </div>                <!-- BODY -->                <div class="modal-body" id="modal-body"> <listado-entidad grid-options="bac.configuracionTabla" entidades-seleccionadas="bec.entidadesSeleccionadas" click-item="bec.clickEntidad($entidad)" entidades="bec.entidades" ></listado-entidad>                             </div><!-- FOOTER --><div class="modal-footer">                <button class="btn btn-primary" type="button" ng-click="bec.aceptar()" ng-disabled="!bec.entitdadSeleccionada">Aceptar</button>                <button class="btn btn-warning" type="button" ng-click="bec.cancelar()">Cancelar</button>                </div>',controller:"BuscarEntidadController",controllerAs:"bec",size:"lg",resolve:{configuracionTabla:function(){return r.busquedaAvanzada},entidades:function(){return r.entidades}},appendTo:void 0});i.result.then(function(n){r.ultimaEntidad=n,d(n)},function(){})}function o(){void 0===r.entidades||0===r.entidades.length?s():r.ultimaEntidad=void 0!==r.ultimaEntidad?r.ultimaEntidad:r.entidades[0]}function a(n){var i="";if(void 0!==n.selected){for(var e in r.configuracion.campos)i+=c(n.selected,r.configuracion.campos[e].field),i+=" - ";i=i.substr(0,i.length-3)}return i}function c(n,i){i=i.replace(/\[(\w+)\]/g,".$1"),i=i.replace(/^\./,"");for(var e=i.split("."),t=0,o=e.length;o>t;++t){var a=e[t];if(!(a in n))return;n=n[a]}return n}function d(n){r.clickItem&&r.clickItem({$event:n})}function s(){void 0!==r.url?r.servicio.obtenerDatos(r.url).then(function(n){r.entidades=n,r.ultimaEntidad=void 0!==r.ultimaEntidad?r.ultimaEntidad:r.entidades[0],r.onLoadData&&r.onLoadData({$item:r.ultimaEntidad})}):r.servicio.obtenerDatos(r.parametros).then(function(n){r.entidades=n,r.ultimaEntidad=void 0!==r.ultimaEntidad?r.ultimaEntidad:r.entidades[0],r.onLoadData&&r.onLoadData({$item:r.ultimaEntidad})})}var r=this;r.byString=c,r.cargarDatos=s,r.cargarCampos=a,r.onSelect=d,r.getSearchEnabled=e,r.getSearch=i,r.showBuscar=t,r.$onInit=function(){o()}}n.module("uiComponents.components").controller("SelectController",i)}(angular);